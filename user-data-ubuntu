#cloud-config
users:
  - name: jerry
    gecos: Jerry Wardlow
    groups: sudo
    sudo: ['ALL=(ALL) NOPASSWD:ALL']
    shell: /bin/bash
    lock-passwd: false
    passwd: $6$rounds=666666$hypertension$LxNM/PPbjauIBoXp0XPgOdYmr/jXvPwei133CZfbUxWoPR6U.JLAKyCFCln33ikGUWIQBEOPVCvLm.7hoHT.f1
    ssh-import-id:
      - gh:jerrywardlow

packages:
  - fail2ban
  - git
  - htop
  - lynx
  - net-tools
  - nmap
  - smem
  - snapd
  - strace
  - tmux
  - tree
  - unzip
  - vim
  - wget

apt_sources:
    - source: "ppa:ubuntu-lxc/lxd-stable"
    - source: "ppa:ubuntu-lxc/lxc-stable"

runcmd:
  - su jerry -c "git clone https://github.com/jerrywardlow/dotfiles /home/jerry/dotfiles/"
  - su jerry -c "~/dotfiles/install.sh"
  - chown -R jerry:jerry /home/jerry/
  - sed -i -e '/^PermitRootLogin/s/^.*$/PermitRootLogin no/' /etc/ssh/sshd_config
  - sed -i -e '/^PasswordAuthentication/s/^.*$/PasswordAuthentication no/' /etc/ssh/sshd_config
  - echo "\nAllowUsers jerry" >> /etc/ssh/sshd_config
  - service ssh restart

final_message: "Total time: $UPTIME"
